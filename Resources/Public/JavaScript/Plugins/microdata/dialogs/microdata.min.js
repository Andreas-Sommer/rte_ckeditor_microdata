function cleanHtml(html){html=html.replaceAll(/<p>|<\/p>|<span\sdata-cke-bookmark="1"\sstyle="display:\snone;">&nbsp;<\/span>/g,"");return html}CKEDITOR.dialog.add("microdataDialog",function(editor){var $parent,bookmarkElement;return{title:"Microdata Properties",minWidth:400,minHeight:200,contents:[{id:"tab-basic",label:"Basic Settings",elements:[{type:"text",id:"question",label:"Question",validate:CKEDITOR.dialog.validate.notEmpty("Question field cannot be empty.")},{type:"textarea",id:"answer",label:"Answer",validate:CKEDITOR.dialog.validate.notEmpty("Answer field cannot be empty.")}]}],onShow:function(){var dialog=this;var selection=editor.getSelection();var bookmark=selection.createBookmarks();bookmarkElement=bookmark[0].startNode.$;$parent=$(bookmarkElement).parents('div[itemprop="mainEntity"]');var question=cleanHtml($parent.find(':header[itemprop="name"]').html());var answer=cleanHtml($parent.find('div[itemprop="text"]').html());dialog.setValueOf("tab-basic","question",question);dialog.setValueOf("tab-basic","answer",answer)},onCancel:function(){$(bookmarkElement).remove()},onOk:function(){var dialog=this;var html='<div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question">\n'+'    <h3 itemprop="name">'+dialog.getValueOf("tab-basic","question")+"</h3>\n"+'    <div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer">\n'+'      <div itemprop="text">\n'+dialog.getValueOf("tab-basic","answer")+"      </div>\n"+"    </div>\n"+"  </div>";$parent.remove();editor.insertHtml(html)}}});
